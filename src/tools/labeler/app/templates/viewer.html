{% extends 'base.html' %}

{% block header %}

{% endblock %}

{% block content %}
  <script type="text/javascript">
/*    document.addEventListener('keydown', (event) => {
      const keyName = event.key;

      if(keyName === "ArrowRight"){
        cursor_next();
      }else if(keyName === "ArrowLeft"){
        cursor_prev();
      }

    }, false);
*/
    function cursor_next(){
       $.ajax
        ({
            type: "GET",
            url: '/labeler/cursor_next',
            async: true,
            success: function () {
              window.location.assign("/labeler")
              var target = document.getElementById('contento');
              var spinner = new Spinner(opts).spin(target);
            }
        });
    }

    function cursor_prev(){
       $.ajax
        ({
            type: "GET",
            url: '/labeler/cursor_prev',
            async: true,
            success: function () {
              window.location.assign("/labeler")
              var target = document.getElementById('contento');
              var spinner = new Spinner(opts).spin(target);
            }
        });
    }

    function change_dataset(dataset){
       $.ajax
        ({
            type: "GET",
            url: '/labeler/change_dataset?dataset='+dataset,
            async: true,
            success: function () {
              window.location.assign("/labeler")
              var target = document.getElementById('contento');
              var spinner = new Spinner(opts).spin(target);
            }
        });
    }
  </script>

  <div class="container-fluid">
  <div class="row" style="height: 100%">
    <div class="col-md-3 myNavigation" style="height: 100%">
      <h3>Datasets</h3>
      <ul class="datasets_list">
        {% for d in datasets %}
          <li class="{{'selected' if d.name == dataset.name else ''}}">
            <a class="dataset" href="#" onclick="change_dataset('{{d.name}}')">{{d.name}}</a>
          </li>
        {% endfor %}
      </ul>

      <h3>Dataset info</h3>
      <p>Samples: <b>{{dataset.X | length}}</b></p>
      <p>Size: <b>{{dataset.X.shape[1]}} x {{dataset.X.shape[2]}}</b></p>

    </div>
    <div class="col-md-9" id="contento">

      {% for c in cursor %}

      <div class="viewer-image-container">
        <img src="data:image/png;base64, {{c.image | safe}}" alt="Red dot" />


      <div>
        <div class='labels'>
        {% for label in c.labels %}
          <!-- <span style="text-align: center;">{{label}}</span> -->
          {% if label != 'corr' %}

          {% for class in range(5) %}
            <div class="viewer-prediction-class {{'prediction-class-selected' if c.labels[label][class] == 1 else ''}}">
              {{'o' if c.labels[label][class] == 1 else '&nbsp;' | safe}}
            </div>

          {% endfor %}
          {% else %}
          {% endif %}
        {% endfor %}
        </div>

      {{cursor.labels}}
    </div>

      </div>

      {% endfor %}


        }

    </div>
  </div>


  </div>
  
{% endblock %}